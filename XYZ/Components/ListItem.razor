@using Need4Protocol;
@using XYZ.Data
@using System.ComponentModel.DataAnnotations
@inject Need4Service Need4Service

<h3>ItemList</h3>


@if (list != null)
{
    <div>
    @foreach (Item i in list.Items)
    {
        <br />
        <span>Name: @i.Name </span>
    }
    </div>
}


@code {
    Item newItem = new Item();
    ItemList list = new ItemList();
    private ItemRepository.ItemRepositoryClient itemClient;

    //private async Task
    protected override void OnInitialized()
    {
        itemClient = Need4Service.GetItemClient();
    }

    private async Task Refresh()
    {
        newItem.Name = string.Empty;
        list = await Task.Run(() => itemClient.GetAllItems(new Google.Protobuf.WellKnownTypes.Empty()));
    }

    protected override async Task OnParametersSetAsync()
    {
        await Refresh();
    }
}
